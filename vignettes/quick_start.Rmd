---
title: "Quick Start Guide for mipBarcodeR"
author: "George Bailey"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Quick Start Guide for mipBarcodeR}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 7,
  fig.height = 5
)
```

# Quick Start Guide for mipBarcodeR

This vignette provides a quick introduction to using the `mipBarcodeR` package for generating barcode sheets for nanopore sequencing.

## Installation

First, install the package:

```{r install, eval = FALSE}
# Install from GitHub
devtools::install_github("gtollefson/mipBarcodeR")

# Or install from local directory
devtools::install("path/to/mipBarcodeR_package")
```

## Loading the Package

```{r load}
library(mipBarcodeR)
```

## Basic Usage

### Step 1: Prepare Your Sample Sheet

Your sample sheet should be a CSV file with the following columns:

- `SampleID`: Unique identifier for each sample
- `FW_Plate`: The FW plate number (e.g., 1, 5, etc.)
- `REV_Plate`: The REV plate number (e.g., 1, 4, etc.)
- `FW_Well`: Well positions for the forward barcode plate (e.g., A01, B02, etc.)
- `REV_Well`: Well positions for the reverse barcode plate (e.g., A01, B02, etc.)

This format allows you to mix different FW/REV combinations in the same sample sheet.

Here's an example of what your sample sheet should look like:

```csv
SampleID,FW_Plate,REV_Plate,FW_Well,REV_Well
Sample_001,1,4,A01,A01
Sample_002,1,4,A02,A02
Sample_003,5,1,C01,C01
Sample_004,5,1,C02,C02
```

### Step 2: Generate a Barcode Sheet

```{r generate, eval = FALSE}
# Create example sample sheet
example_data <- data.table::data.table(
  SampleID = c("Sample_001", "Sample_002", "Sample_003"),
  FW_Plate = c(1, 1, 5),
  REV_Plate = c(4, 4, 1),
  FW_Well = c("A01", "A02", "C01"),
  REV_Well = c("A01", "A02", "C01")
)

# Write to temporary file
temp_file <- tempfile(fileext = ".csv")
data.table::fwrite(example_data, temp_file)

# Generate barcode sheet
barcode_sheet <- generate_barcode_sheet(temp_file)

# View the results
head(barcode_sheet)

# Clean up
unlink(temp_file)
```

### Step 3: Write the Barcode Sheet to File

```{r write, eval = FALSE}
# Create output directory
output_dir <- "output"
if (!dir.exists(output_dir)) {
  dir.create(output_dir, recursive = TRUE)
}

# Write barcode sheet to file
output_file <- write_barcode_sheet(
  barcode_sheet = barcode_sheet,
  output_path = output_dir,
  filename = "my_project",
  project_name = "nanopore_run"
)

cat("Barcode sheet written to:", output_file)
```

## Advanced Usage

### Checking for Duplicates

The package automatically checks for duplicate barcode pairs, but you can also check manually:

```{r duplicates, eval = FALSE}
# Create a sample sheet with potential duplicates
duplicate_test_sheet <- data.table::data.table(
  sample_name = c("Sample1", "Sample2", "Sample3", "Sample4"),
  fw = c("ATCG", "GCTA", "ATCG", "TAGC"),
  rev = c("GCTA", "ATCG", "GCTA", "CGAT")
)

# Check for duplicates
duplicates <- check_duplicate_barcode_pairs(duplicate_test_sheet)
```

## Package Features

### Built-in Lookup Tables

The package includes all necessary lookup tables for FW primers (1-96) and REV plates (1-4):

```{r lookup, eval = FALSE}
# Load lookup tables for REV-4
lookup_tables <- load_lookup_tables(rev_number = 4)

# Check available data
names(lookup_tables)
```

### Input Validation

The package includes comprehensive validation:

```{r validation, eval = FALSE}
# Example of validation
sample_sheet <- data.table::data.table(
  SampleID = c("Sample1", "Sample2"),
  FW_Plate = c(1, 5),
  REV_Plate = c(4, 1),
  FW_Well = c("A01", "C01"),
  REV_Well = c("A01", "C01")
)

# Validate the sample sheet
validate_sample_sheet(sample_sheet)
```

## Output Format

The generated barcode sheets are saved as TSV files with the following columns:

- `sample_name`: The sample identifier
- `fw`: Forward barcode sequence
- `rev`: Reverse barcode sequence

This format is compatible with nanopore sequencing platforms.

## Error Handling

The package includes comprehensive error checking:

- Validates sample sheet structure
- Checks for missing required columns
- Identifies duplicate barcode pairs
- Provides informative error messages
- Validates FW/REV combinations against available lookup tables

## Support

For issues, questions, or feature requests, please open an issue on the GitHub repository. 